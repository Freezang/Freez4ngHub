
local script = [[cHJpbnQoIkZJQ0hJRVIgU0VDVVJJU0UgQlkgRlJFRVpBTkcuIikKbG9jYWwgUmF5ZmllbGQgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgnaHR0cHM6Ly9zaXJpdXMubWVudS9yYXlmaWVsZCcpKSgpCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQpsb2NhbCBSdW5TZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFN0YXJ0ZXJHdWkgPSBnYW1lOkdldFNlcnZpY2UoIlN0YXJ0ZXJHdWkiKQoKbG9jYWwgb3duZXJOYW1lID0gImZyZWV6NG5nIgpsb2NhbCBvd25lcklkID0gNzU3MTc2MTc4MgoKLS0gVGFibGUgcG91ciBlbnJlZ2lzdHJlciBsZXMgam91ZXVycyBheWFudCBleMOpY3V0w6kgbGUgc2NyaXB0CmxvY2FsIHNjcmlwdFVzZXJzID0ge30KCmxvY2FsIGZ1bmN0aW9uIHNlbmROb3RpZmljYXRpb24odGl0bGUsIHRleHQsIGR1cmF0aW9uKQogICAgU3RhcnRlckd1aTpTZXRDb3JlKCJTZW5kTm90aWZpY2F0aW9uIiwgewogICAgICAgIFRpdGxlID0gdGl0bGUsCiAgICAgICAgVGV4dCA9IHRleHQsCiAgICAgICAgRHVyYXRpb24gPSBkdXJhdGlvbiBvciA1LCAtLSBEdXLDqWUgcGFyIGTDqWZhdXQgZGUgNSBzZWNvbmRlcwogICAgfSkKZW5kCgotLSBFbnJlZ2lzdHJlciBsJ3V0aWxpc2F0ZXVyIGR1IHNjcmlwdApsb2NhbCBsb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKaWYgbG9jYWxQbGF5ZXIgdGhlbgogICAgdGFibGUuaW5zZXJ0KHNjcmlwdFVzZXJzLCBsb2NhbFBsYXllci5Vc2VySWQpCmVuZAoKLS0gU3VydmVpbGxlciBxdWFuZCB1biBqb3VldXIgcmVqb2ludApQbGF5ZXJzLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgaWYgcGxheWVyLlVzZXJJZCA9PSBvd25lcklkIHRoZW4KICAgICAgICAtLSBMZSBwcm9wcmnDqXRhaXJlIGEgcmVqb2ludCwgbm90aWZpZXIgdG91cyBsZXMgdXRpbGlzYXRldXJzIGR1IHNjcmlwdAogICAgICAgIGZvciBfLCB1c2VySWQgaW4gaXBhaXJzKHNjcmlwdFVzZXJzKSBkbwogICAgICAgICAgICBsb2NhbCB1c2VyUGxheWVyID0gUGxheWVyczpHZXRQbGF5ZXJCeVVzZXJJZCh1c2VySWQpCiAgICAgICAgICAgIGlmIHVzZXJQbGF5ZXIgYW5kIHVzZXJQbGF5ZXIgPT0gbG9jYWxQbGF5ZXIgdGhlbgogICAgICAgICAgICAgICAgc2VuZE5vdGlmaWNhdGlvbigiQWxlcnRlIiwgIkxlIG93bmVyIGR1IHNjcmlwdCBhIHJlam9pbnQgISIsIDUpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZUxvYWRpbmdTY3JlZW4obWVzc2FnZSwgc3VidGl0bGVNZXNzYWdlLCBkdXJhdGlvbiwgcHJvZ3Jlc3NTcGVlZCkKICAgIGxvY2FsIHNjcmVlbkd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKICAgIGxvY2FsIGZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICBsb2NhbCB0aXRsZSA9IEluc3RhbmNlLm5ldygiVGV4dExhYmVsIikKICAgIGxvY2FsIHByb2dyZXNzQmFyQ29udGFpbmVyID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICBsb2NhbCBwcm9ncmVzc0JhciA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQogICAgbG9jYWwgc3VidGl0bGUgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICAKICAgIC0tIFByb3ByacOpdMOpcyBkdSBTY3JlZW5HdWkKICAgIHNjcmVlbkd1aS5OYW1lID0gIkxvYWRpbmdTY3JlZW4iCiAgICBzY3JlZW5HdWkuUGFyZW50ID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyOldhaXRGb3JDaGlsZCgiUGxheWVyR3VpIikKICAgIHNjcmVlbkd1aS5JZ25vcmVHdWlJbnNldCA9IHRydWUKCiAgICAtLSBDYWRyZSBwcmluY2lwYWwKICAgIGZyYW1lLk5hbWUgPSAiTWFpbkZyYW1lIgogICAgZnJhbWUuUGFyZW50ID0gc2NyZWVuR3VpCiAgICBmcmFtZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzAsIDMwLCAzMCkKICAgIGZyYW1lLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCkKICAgIGZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCgogICAgLS0gVGl0cmUKICAgIHRpdGxlLk5hbWUgPSAiVGl0bGUiCiAgICB0aXRsZS5QYXJlbnQgPSBmcmFtZQogICAgdGl0bGUuVGV4dCA9IG1lc3NhZ2UKICAgIHRpdGxlLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgdGl0bGUuVGV4dFNpemUgPSAzMgogICAgdGl0bGUuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCiAgICB0aXRsZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgdGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygwLjYsIDAsIDAuMSwgMCkKICAgIHRpdGxlLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC40LCAwKQogICAgdGl0bGUuQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSkKICAgIHRpdGxlLlRleHRTY2FsZWQgPSB0cnVlCgogICAgLS0gQmFycmUgZGUgcHJvZ3Jlc3Npb24KICAgIHByb2dyZXNzQmFyQ29udGFpbmVyLk5hbWUgPSAiUHJvZ3Jlc3NCYXJDb250YWluZXIiCiAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5QYXJlbnQgPSBmcmFtZQogICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDUwLCA1MCwgNTApCiAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5TaXplID0gVURpbTIubmV3KDAuNiwgMCwgMC4wNSwgMCkKICAgIHByb2dyZXNzQmFyQ29udGFpbmVyLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKQogICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSkKICAgIHByb2dyZXNzQmFyQ29udGFpbmVyLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCgogICAgbG9jYWwgY29udGFpbmVyVUlDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKICAgIGNvbnRhaW5lclVJQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEyKQogICAgY29udGFpbmVyVUlDb3JuZXIuUGFyZW50ID0gcHJvZ3Jlc3NCYXJDb250YWluZXIKCiAgICBwcm9ncmVzc0Jhci5OYW1lID0gIlByb2dyZXNzQmFyIgogICAgcHJvZ3Jlc3NCYXIuUGFyZW50ID0gcHJvZ3Jlc3NCYXJDb250YWluZXIKICAgIHByb2dyZXNzQmFyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxNzAsIDI1NSkKICAgIHByb2dyZXNzQmFyLlNpemUgPSBVRGltMi5uZXcoMCwgMCwgMSwgMCkKCiAgICBsb2NhbCBwcm9ncmVzc1VJQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCiAgICBwcm9ncmVzc1VJQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEyKQogICAgcHJvZ3Jlc3NVSUNvcm5lci5QYXJlbnQgPSBwcm9ncmVzc0JhcgoKICAgIC0tIFNvdXMtdGl0cmUKICAgIHN1YnRpdGxlLk5hbWUgPSAiU3VidGl0bGUiCiAgICBzdWJ0aXRsZS5QYXJlbnQgPSBmcmFtZQogICAgc3VidGl0bGUuVGV4dCA9IHN1YnRpdGxlTWVzc2FnZQogICAgc3VidGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW0KICAgIHN1YnRpdGxlLlRleHRTaXplID0gMTgKICAgIHN1YnRpdGxlLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMDAsIDIwMCwgMjAwKQogICAgc3VidGl0bGUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIHN1YnRpdGxlLlNpemUgPSBVRGltMi5uZXcoMC42LCAwLCAwLjA1LCAwKQogICAgc3VidGl0bGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjU3LCAwKQogICAgc3VidGl0bGUuQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSkKICAgIHN1YnRpdGxlLlRleHRTY2FsZWQgPSB0cnVlCgogICAgLS0gQW5pbWF0aW9uIGQnZW50csOpZQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoZnJhbWUsIFR3ZWVuSW5mby5uZXcoMSksIHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMH0pOlBsYXkoKQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUocHJvZ3Jlc3NCYXJDb250YWluZXIsIFR3ZWVuSW5mby5uZXcoMSksIHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMH0pOlBsYXkoKQoKICAgIC0tIFJlbXBsaXNzYWdlIHByb2dyZXNzaWYKICAgIGZvciBpID0gMSwgMTAwIGRvCiAgICAgICAgcHJvZ3Jlc3NCYXIuU2l6ZSA9IFVEaW0yLm5ldyhpIC8gMTAwLCAwLCAxLCAwKQogICAgICAgIHRhc2sud2FpdChwcm9ncmVzc1NwZWVkKQogICAgZW5kCgogICAgLS0gQW5pbWF0aW9uIGRlIHNvcnRpZQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUoZnJhbWUsIFR3ZWVuSW5mby5uZXcoMSksIHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMX0pOlBsYXkoKQogICAgZ2FtZTpHZXRTZXJ2aWNlKCJUd2VlblNlcnZpY2UiKTpDcmVhdGUocHJvZ3Jlc3NCYXJDb250YWluZXIsIFR3ZWVuSW5mby5uZXcoMSksIHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMX0pOlBsYXkoKQogICAgdGFzay53YWl0KDEpCgogICAgLS0gU3VwcHJlc3Npb24KICAgIHNjcmVlbkd1aTpEZXN0cm95KCkKZW5kCgpwcmludCgiIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMiKQpwcmludCgiIyAgICBGcmVlejRuZyBIdWIgICAgICMiKQpwcmludCgiIyAgIFsgLSBMb2FkZWQgISAtIF0gICMiKQpwcmludCgiIyAgICAgICAgICAgICB7VjEuMS4yfSMiKQpwcmludCgiIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMiKQoKCi0tIFByZW1pZXIgw6ljcmFuIGRlIGNoYXJnZW1lbnQgdW5pdmVyc2VsCmNyZWF0ZUxvYWRpbmdTY3JlZW4oCiAgICAiRnJlZXo0bmcgSHViIG9uIHRvcCDwn46HIiwKICAgICJQYXRpZW5jZSBlc3QgbGEgY2zDqSBkZSBsYSByw6l1c3NpdGUuLi4g8J+agCIsCiAgICA1LAogICAgMC4wNQopCgppZiBnYW1lLlBsYWNlSWQgPT0gNjg4NDMxOTE2OSB0aGVuCiAgICBjcmVhdGVMb2FkaW5nU2NyZWVuKAogICAgICAgICJNaWMgVXAgZGV0ZWN0w6kiLAogICAgICAgICItIEJhc2VwbGF0ZSDDqWxhcmdpZS4g8J+PnVxuIC0gU29sIGRlIGxhIHByaXZhdGUgcm9vbSBzb2xpZGlmacOpLiDwn5SoIiwKICAgICAgICBuaWwsCiAgICAgICAgMC4xCiAgICApCgogICAgLS0gVGFpbGxlIGQndW4gc2VnbWVudCBkZSBsYSBiYXNlcGxhdGUgKHBsdXMgcsOpYWxpc3RlKQogICAgbG9jYWwgc2VnbWVudFNpemUgPSAxMDAwIC0tIENoYXF1ZSBzZWdtZW50IGZhaXQgMTAwMHgxMDAwIHN0dWRzCiAgICBsb2NhbCBncmlkU2l6ZSA9IDUwIC0tIE5vbWJyZSBkZSBzZWdtZW50cyBkYW5zIGNoYXF1ZSBkaXJlY3Rpb24gKDUweDUwID0gMiA1MDAgc2VnbWVudHMpCgogICAgLS0gQ2VudHJlIGRlIGxhIGdyaWxsZSBiYXPDqSBzdXIgbGEgcG9zaXRpb24gZHUgam91ZXVyCiAgICBsb2NhbCBwbGF5ZXJQb3NpdGlvbiA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbgogICAgbG9jYWwgYmFzZUNlbnRlclggPSBtYXRoLmZsb29yKHBsYXllclBvc2l0aW9uLlggLyBzZWdtZW50U2l6ZSkgKiBzZWdtZW50U2l6ZQogICAgbG9jYWwgYmFzZUNlbnRlclogPSBtYXRoLmZsb29yKHBsYXllclBvc2l0aW9uLlogLyBzZWdtZW50U2l6ZSkgKiBzZWdtZW50U2l6ZQoKICAgIC0tIENyw6lhdGlvbiBkZXMgc2VnbWVudHMKICAgIGZvciB4ID0gLWdyaWRTaXplLCBncmlkU2l6ZSBkbwogICAgICAgIGZvciB6ID0gLWdyaWRTaXplLCBncmlkU2l6ZSBkbwogICAgICAgICAgICBsb2NhbCBuZXdTZWdtZW50ID0gSW5zdGFuY2UubmV3KCJQYXJ0IikKICAgICAgICAgICAgbmV3U2VnbWVudC5TaXplID0gVmVjdG9yMy5uZXcoc2VnbWVudFNpemUsIDEsIHNlZ21lbnRTaXplKSAtLSBUYWlsbGUgZHUgc2VnbWVudAogICAgICAgICAgICBuZXdTZWdtZW50LlBvc2l0aW9uID0gVmVjdG9yMy5uZXcoCiAgICAgICAgICAgICAgICBiYXNlQ2VudGVyWCArICh4ICogc2VnbWVudFNpemUpLAogICAgICAgICAgICAgICAgLTAuNSwKICAgICAgICAgICAgICAgIGJhc2VDZW50ZXJaICsgKHogKiBzZWdtZW50U2l6ZSkKICAgICAgICAgICAgKQogICAgICAgICAgICBuZXdTZWdtZW50LkFuY2hvcmVkID0gdHJ1ZQogICAgICAgICAgICBuZXdTZWdtZW50Lk1hdGVyaWFsID0gRW51bS5NYXRlcmlhbC5HcmFzcwogICAgICAgICAgICBuZXdTZWdtZW50LkJyaWNrQ29sb3IgPSBCcmlja0NvbG9yLm5ldygiQnJpZ2h0IGdyZWVuIikKICAgICAgICAgICAgbmV3U2VnbWVudC5DYW5Db2xsaWRlID0gdHJ1ZQogICAgICAgICAgICBuZXdTZWdtZW50Lk5hbWUgPSAiQmFzZVNlZ21lbnQiCiAgICAgICAgICAgIG5ld1NlZ21lbnQuUGFyZW50ID0gd29ya3NwYWNlCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICAtLSBDRnJhbWUgY2libGUgw6AgcmVjaGVyY2hlcgogICAgbG9jYWwgdGFyZ2V0Q0ZyYW1lID0gQ0ZyYW1lLm5ldygKICAgICAgICA0MjIwLjYwOTM4LCAyLjcxNTczNDQ4LCA2MS4xMjg4NjQzLCAKICAgICAgICAtMSwgMCwgMCwgCiAgICAgICAgMCwgMSwgMCwgCiAgICAgICAgMCwgMCwgLTEKICAgICkKCiAgICAtLSBQYXJjb3VyaXIgbGVzIG1vZMOobGVzICJSb29tIiBkYW5zIGxlIGB3b3Jrc3BhY2VgCiAgICBmb3IgXywgcm9vbSBpbiBpcGFpcnMod29ya3NwYWNlOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgcm9vbTpJc0EoIk1vZGVsIikgYW5kIHJvb20uTmFtZSA9PSAiUm9vbSIgdGhlbgogICAgICAgICAgICAtLSBSZWNoZXJjaGVyIHVuZSBgUGFydGAgYXZlYyBsYSBDRnJhbWUgY2libGUgZGFucyBsZSBtb2TDqGxlICJSb29tIgogICAgICAgICAgICBmb3IgXywgcGFydCBpbiBpcGFpcnMocm9vbTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgcGFydDpJc0EoIlBhcnQiKSBhbmQgcGFydC5DRnJhbWUgPT0gdGFyZ2V0Q0ZyYW1lIHRoZW4KICAgICAgICAgICAgICAgICAgICBwYXJ0LkNhbkNvbGxpZGUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgLS0gcHJpbnQoIkNhbkNvbGxpZGUgYWN0aXbDqSBwb3VyIDoiLCBwYXJ0OkdldEZ1bGxOYW1lKCkpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgoKLS0gQ3LDqWF0aW9uIGRlIGxhIGZlbsOqdHJlIHByaW5jaXBhbGUKbG9jYWwgV2luZG93ID0gUmF5ZmllbGQ6Q3JlYXRlV2luZG93KHsKICAgTmFtZSA9ICJGcmVlejRuZyBIdWIgfCBVcGRhdGVkIDogMDgvMTIvMjQgLSAyMWg0MSB78J+Hq/Cfh7d9IiwKICAgTG9hZGluZ1RpdGxlID0gIk1ha2UgYmV0dGVyIDogRnJlZXo0bmcgSHViLi4uIiwKICAgTG9hZGluZ1N1YnRpdGxlID0gIi0gQnkgRnJlZXo0bmcgLSIsCiAgIENvbmZpZ3VyYXRpb25TYXZpbmcgPSB7CiAgICAgIEVuYWJsZWQgPSBmYWxzZQogICB9LAogICBLZXlTeXN0ZW0gPSBmYWxzZQp9KQoKbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKbG9jYWwgc3VibWl0VGV4dEV2ZW50ID0gUmVwbGljYXRlZFN0b3JhZ2U6RmluZEZpcnN0Q2hpbGQoIlN1Ym1pdFRleHRFdmVudCIpCgoKbG9jYWwgYmFzZVNlZ21lbnRzQ29sbGlkYWJsZSA9IHRydWUKLS0gQ3LDqWF0aW9uIGRlIGwnb25nbGV0IHByaW5jaXBhbApsb2NhbCBNZW51ID0gV2luZG93OkNyZWF0ZVRhYigi8J+PoCBNYWluIikKbG9jYWwgTWFpblRhYiA9IFdpbmRvdzpDcmVhdGVUYWIoIuKtkCBLZXlCaW5kcyIpCmxvY2FsIFRvb2xzVGFiID0gV2luZG93OkNyZWF0ZVRhYigi8J+qkyBUb29scyIpCmxvY2FsIEFjdGl2YXRlVGFiID0gV2luZG93OkNyZWF0ZVRhYigi8J+XnSBBY3RpdmF0ZSIpCmxvY2FsIFRwVGFiID0gV2luZG93OkNyZWF0ZVRhYigi8J+TjSBUw6lsw6lwb3J0YXRpb24iKQotLSBWYXJpYWJsZXMgcG91ciBsZSBzdWl2aQpsb2NhbCBpc0ZvbGxvd2luZyA9IGZhbHNlCmxvY2FsIGZvbGxvd1Rhc2sKbG9jYWwgYWN0aXZhdGlvbktleSA9IEVudW0uS2V5Q29kZS5GCmxvY2FsIHRyaXBLZXkgPSBFbnVtLktleUNvZGUuRwoKQWN0aXZhdGVUYWI6Q3JlYXRlTGFiZWwoIuKdkyAtIENlbGEgc2VydCDDoCBhY3RpdmVyIGxlcyBwYXJjb3VycywgYXUgbGlldSBkJ2F2b2lyIMOgIG1vbnRlciBlbiBoYXV0IGRlIGxhIHRvdXIgcG91ciBsZSBmYWlyZSBtYW51ZWxsZW1lbnQsIHZvdXMgbCdhdmV6IGljaS4iKQpUcFRhYjpDcmVhdGVMYWJlbCgi4p2TIC0gQ2VsYSBzZXJ0IMOgIHNlIHTDqWzDqXBvcnRlciDDoCBkaWZmw6lyZW50cyBlbmRyb2l0cyBkZSBsYSBtYXAgZGUgTWljIFVwLCBoaXN0b2lyZSBkZSBnYWduZXIgZHUgdGVtcHMuIikKVG9vbHNUYWI6Q3JlYXRlTGFiZWwoIuKdkyAtIENlbGEgc2VydCDDoCBzZSBkb25uZXIgZGVzICdvdXRpbHMnIGRhbnMgdm90cmUgaW52ZW50YWlyZSBwb3VyIGZhaXJlIGRpdmVyc2VzIGNob3Nlcy4iKQoKCmlmIG5vdCBzdWJtaXRUZXh0RXZlbnQgb3Igbm90IHN1Ym1pdFRleHRFdmVudDpJc0EoIlJlbW90ZUV2ZW50IikgdGhlbgogICAgd2FybigiU3VibWl0VGV4dEV2ZW50IG4nZXhpc3RlIHBhcyBvdSBuJ2VzdCBwYXMgdW4gUmVtb3RlRXZlbnQiKQogICAgcmV0dXJuCmVuZAoKLS0gVmFyaWFibGUgcG91ciBjb250csO0bGVyIGwnw6l0YXQgZGUgbCdlbnZvaQpsb2NhbCBpc1NlbmRpbmdUZXh0ID0gZmFsc2UKCi0tIFN1cHByaW1lIHRvdXRlcyBsZXMgYW5pbWF0aW9ucyBlbiBjb3Vycwpsb2NhbCBmdW5jdGlvbiBjbGVhckFuaW1hdGlvbnMoaHVtYW5vaWQpCiAgICBmb3IgXywgYW5pbVRyYWNrIGluIGlwYWlycyhodW1hbm9pZDpHZXRQbGF5aW5nQW5pbWF0aW9uVHJhY2tzKCkpIGRvCiAgICAgICAgYW5pbVRyYWNrOlN0b3AoKQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlQ0ZyYW1lTW92ZW1lbnQoKQogICAgaWYgbm90IGlzQ0ZyYW1lVG9nZ2xpbmcgdGhlbgogICAgICAgIGlzQ0ZyYW1lVG9nZ2xpbmcgPSB0cnVlCiAgICAgICAgd2hpbGUgaXNDRnJhbWVUb2dnbGluZyBkbwogICAgICAgICAgICBsb2NhbCByb290ID0gQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgaWYgcm9vdCB0aGVuCiAgICAgICAgICAgICAgICByb290LkNGcmFtZSA9IHJvb3QuQ0ZyYW1lICogQ0ZyYW1lLm5ldygwLjUsIDAsIDApIC0tIETDqXBsYWNlbWVudCDDoCBkcm9pdGUKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjA1KSAtLSBUcsOocyByYXBpZGUKICAgICAgICAgICAgICAgIHJvb3QuQ0ZyYW1lID0gcm9vdC5DRnJhbWUgKiBDRnJhbWUubmV3KC0xLCAwLCAwKSAtLSBEw6lwbGFjZW1lbnQgw6AgZ2F1Y2hlCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wNSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbHNlCiAgICAgICAgaXNDRnJhbWVUb2dnbGluZyA9IGZhbHNlCiAgICBlbmQKZW5kCgotLSBEw6l0ZWN0ZXIgbGVzIGFwcHVpcyBzdXIgbGEgdG91Y2hlIGNvbmZpZ3Vyw6llClVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LCBnYW1lUHJvY2Vzc2VkKQogICAgaWYgZ2FtZVByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKICAgIGlmIGlucHV0LktleUNvZGUgPT0gY3VycmVudEtleSB0aGVuCiAgICAgICAgdG9nZ2xlQ0ZyYW1lTW92ZW1lbnQoKQogICAgZW5kCmVuZCkKCmxvY2FsIGZ1bmN0aW9uIHRvZ2dsZVRleHRTZW5kaW5nKGlzRW5hYmxlZCkKICAgIGlzU2VuZGluZ1RleHQgPSBpc0VuYWJsZWQKICAgIGlmIGlzU2VuZGluZ1RleHQgdGhlbgogICAgICAgIC0tIETDqW1hcnJlciB1bmUgYm91Y2xlIHRhbnQgcXVlIGMnZXN0IGFjdGl2w6kKICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgd2hpbGUgaXNTZW5kaW5nVGV4dCBkbwogICAgICAgICAgICAgICAgc3VibWl0VGV4dEV2ZW50OkZpcmVTZXJ2ZXIoIlN0b3AiKSAtLSBFbnZvaWUgbGUgdGV4dGUgYXUgUmVtb3RlRXZlbnQKICAgICAgICAgICAgICAgIHN1Ym1pdFRleHRFdmVudDpGaXJlU2VydmVyKCJTdG9wIikKICAgICAgICAgICAgICAgIHN1Ym1pdFRleHRFdmVudDpGaXJlU2VydmVyKCJTdG9wIikKICAgICAgICAgICAgICAgIHRhc2sud2FpdCgwLjAxKSAtLSBUcsOocyBmYWlibGUgZMOpbGFpIHBvdXIgw6l2aXRlciBsZXMgc3VyY2hhcmdlcwogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCgotLSBGb25jdGlvbiBwb3VyIHRyb3V2ZXIgbGUgam91ZXVyIGxlIHBsdXMgcHJvY2hlCmxvY2FsIGZ1bmN0aW9uIGdldENsb3Nlc3RQbGF5ZXIoKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgIGxvY2FsIGNsb3Nlc3REaXN0YW5jZSA9IG1hdGguaHVnZQogICAgbG9jYWwgY2xvc2VzdFBsYXllciA9IG5pbAoKICAgIGZvciBfLCBvdGhlclBsYXllciBpbiBpcGFpcnMoZ2FtZS5QbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICBpZiBvdGhlclBsYXllciB+PSBwbGF5ZXIgYW5kIG90aGVyUGxheWVyLkNoYXJhY3RlciBhbmQgb3RoZXJQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICBsb2NhbCBkaXN0YW5jZSA9IChjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbiAtIG90aGVyUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgaWYgZGlzdGFuY2UgPCBjbG9zZXN0RGlzdGFuY2UgdGhlbgogICAgICAgICAgICAgICAgY2xvc2VzdERpc3RhbmNlID0gZGlzdGFuY2UKICAgICAgICAgICAgICAgIGNsb3Nlc3RQbGF5ZXIgPSBvdGhlclBsYXllcgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIGNsb3Nlc3RQbGF5ZXIKZW5kCgpsb2NhbCBmdW5jdGlvbiB0b2dnbGVNb2RlbChtb2RlbCwgc3RhdGUpCiAgICBmb3IgXywgcGFydCBpbiBpcGFpcnMobW9kZWw6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICBpZiBwYXJ0OklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgIHBhcnQuVHJhbnNwYXJlbmN5ID0gc3RhdGUgYW5kIDAgb3IgMQogICAgICAgICAgICBwYXJ0LkNhbkNvbGxpZGUgPSBzdGF0ZQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKLS0gUGFyY291cnQgdG91cyBsZXMgbW9kw6hsZXMgZGFucyBXb3Jrc3BhY2UuT2JieQpmb3IgXywgbW9kZWwgaW4gaXBhaXJzKHdvcmtzcGFjZS5PYmJ5OkdldENoaWxkcmVuKCkpIGRvCiAgICBpZiBtb2RlbDpJc0EoIk1vZGVsIikgdGhlbgogICAgICAgIC0tIEFqb3V0IGQndW4gYm91dG9uIMOgIGNvY2hlciBwb3VyIGNoYXF1ZSBtb2TDqGxlCiAgICAgICAgQWN0aXZhdGVUYWI6Q3JlYXRlVG9nZ2xlKHsKICAgICAgICAgICAgTmFtZSA9IG1vZGVsLk5hbWUsCiAgICAgICAgICAgIEN1cnJlbnRWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBGbGFnID0gIlRvZ2dsZV8iIC4uIG1vZGVsLk5hbWUsCiAgICAgICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgICAgICAgICB0b2dnbGVNb2RlbChtb2RlbCwgc3RhdGUpCiAgICAgICAgICAgIGVuZAogICAgICAgIH0pCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBzdGFydEZvbGxvd2luZygpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgIGxvY2FsIGNoYXJhY3RlciA9IHBsYXllci5DaGFyYWN0ZXIgb3IgcGxheWVyLkNoYXJhY3RlckFkZGVkOldhaXQoKQogICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikKICAgIGxvY2FsIHJvb3RQYXJ0ID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKCiAgICBpZiBub3QgaHVtYW5vaWQgb3Igbm90IHJvb3RQYXJ0IHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tIETDqXNhY3RpdmVyIGxlcyBtb3V2ZW1lbnRzIGNsYXNzaXF1ZXMgZXQgc3VwcHJpbWVyIGxlcyBhbmltYXRpb25zCiAgICBodW1hbm9pZC5XYWxrU3BlZWQgPSAwCiAgICBodW1hbm9pZC5KdW1wUG93ZXIgPSAwCiAgICBjbGVhckFuaW1hdGlvbnMoaHVtYW5vaWQpCgogICAgLS0gTGFuY2VyIGxlIHN1aXZpCiAgICBmb2xsb3dUYXNrID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHRhcmdldCA9IGdldENsb3Nlc3RQbGF5ZXIoKQogICAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0LkNoYXJhY3RlciBhbmQgdGFyZ2V0LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgdGFyZ2V0Um9vdCA9IHRhcmdldC5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICBsb2NhbCB0YXJnZXRQb3NpdGlvbiA9IHRhcmdldFJvb3QuUG9zaXRpb24KCiAgICAgICAgICAgIC0tIERpc3RhbmNlIHByb2NoZSBtYWlzIGNvbnRyw7Rsw6llCiAgICAgICAgICAgIGxvY2FsIGZvbGxvd0Rpc3RhbmNlID0gMSAtLSBEaXN0YW5jZSBwYXIgZMOpZmF1dCBkZXJyacOocmUgbGUgam91ZXVyCiAgICAgICAgICAgIGxvY2FsIGJhc2VQb3NpdGlvbiA9IHRhcmdldFBvc2l0aW9uIC0gdGFyZ2V0Um9vdC5DRnJhbWUuTG9va1ZlY3RvciAqIGZvbGxvd0Rpc3RhbmNlCgogICAgICAgICAgICAtLSBPc2NpbGxhdGlvbiByYXBpZGUgYXZhbnQtYXJyacOocmUgKG1haXMgc2FucyBkw6lwYXNzZXIgbGEgY2libGUpCiAgICAgICAgICAgIGxvY2FsIG9zY2lsbGF0aW9uID0gbWF0aC5zaW4odGljaygpICogNTApICogMC41IC0tIFZhLWV0LXZpZW50IHJhcGlkZSwgYW1wbGl0dWRlIGxpbWl0w6llCiAgICAgICAgICAgIGxvY2FsIGZvbGxvd1Bvc2l0aW9uID0gYmFzZVBvc2l0aW9uICsgdGFyZ2V0Um9vdC5DRnJhbWUuTG9va1ZlY3RvciAqIG1hdGgubWF4KG9zY2lsbGF0aW9uLCAwKQoKICAgICAgICAgICAgLS0gU3RhYmlsaXNhdGlvbiBwb3VyIMOpdml0ZXIgZGVzIGNvbmZsaXRzCiAgICAgICAgICAgIHJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoZm9sbG93UG9zaXRpb24sIHRhcmdldFBvc2l0aW9uKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCgotLSBBcnLDqnRlciBsZSBzdWl2aSBldCByZXN0YXVyZXIgbGVzIHBhcmFtw6h0cmVzCmxvY2FsIGZ1bmN0aW9uIHN0b3BGb2xsb3dpbmcoKQogICAgbG9jYWwgcGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCgogICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgIC0tIFJlc3RhdXJlciBsZXMgbW91dmVtZW50cyBkdSBqb3VldXIKICAgICAgICBodW1hbm9pZC5XYWxrU3BlZWQgPSAxNgogICAgICAgIGh1bWFub2lkLkp1bXBQb3dlciA9IDUwCiAgICBlbmQKCiAgICAtLSBEw6ljb25uZWN0ZXIgbGUgc3VpdmkKICAgIGlmIGZvbGxvd1Rhc2sgdGhlbgogICAgICAgIGZvbGxvd1Rhc2s6RGlzY29ubmVjdCgpCiAgICAgICAgZm9sbG93VGFzayA9IG5pbAogICAgZW5kCmVuZAoKLS0gQWN0aXZhdGlvbi9kw6lzYWN0aXZhdGlvbiBhdmVjIGxhIHRvdWNoZQpnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQsIGdhbWVQcm9jZXNzZWQpCiAgICBpZiBnYW1lUHJvY2Vzc2VkIHRoZW4gcmV0dXJuIGVuZCAtLSBJZ25vcmUgc2kgdW5lIGludGVyZmFjZSB1dGlsaXNhdGV1ciBibG9xdWUgbCdlbnRyw6llCiAgICBpZiBpbnB1dC5LZXlDb2RlID09IGFjdGl2YXRpb25LZXkgdGhlbgogICAgICAgIGlzRm9sbG93aW5nID0gbm90IGlzRm9sbG93aW5nCgogICAgICAgIGlmIGlzRm9sbG93aW5nIHRoZW4KICAgICAgICAgICAgUmF5ZmllbGQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkJhbmcgYnkgZnJlZXo0bmciLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJCYW5nIGJ5IGZyZWV6NG5nIGFjdGl2w6kgISAiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHN0YXJ0Rm9sbG93aW5nKCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIFJheWZpZWxkOk5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJCYW5nIGJ5IGZyZWV6NG5nIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiQmFuZyBieSBmcmVlejRuZyBkw6lzYWN0aXbDqS4iLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHN0b3BGb2xsb3dpbmcoKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCi0tIEluZGljYXRpb24gZGUgbGEgdG91Y2hlIGQnYWN0aXZhdGlvbiBkYW5zIGwnaW50ZXJmYWNlCk1lbnU6Q3JlYXRlTGFiZWwoIvCfkYsgLSBCaWVudmVudWUgZGFucyBtb24gSHViLiAoIEJFVEEgLyBNaXNlIMOgIGpvdXIgZW5jb3JlIGVuIGNvdXJzLi4gKSIpCk1lbnU6Q3JlYXRlTGFiZWwoIvCflKggLSBDZSBzY3JpcHQgZXN0IHVuaXZlcnNlbCwgdm91cyBwb3V2ZXogZG9uYyBsJ3V0aWxpc2VyIHN1ciB0b3VzIGxlcyBqZXV4LiIpCk1haW5UYWI6Q3JlYXRlTGFiZWwoIuKGkyBCYW5nIGJ5IGZyZWV6NG5nIOKGkyAtIEZhaXMgZGVzIHZhIGV0IHZpZW50IGRlcnJpw6hyZSBsZSBqb3VldXIgbGUgcGx1cyBwcm9jaGUgZGUgdm91cy4iKQoKLS0gQWpvdXQgZCd1biDDqWzDqW1lbnQgcG91ciBjaGFuZ2VyIGxhIHRvdWNoZSBkJ2FjdGl2YXRpb24KTWFpblRhYjpDcmVhdGVJbnB1dCh7CiAgICBOYW1lID0gIkNoYW5nZSBCYW5nIEtleSAoUGFyIGTDqWZhdXQgOiBGKSIsCiAgICBQbGFjZWhvbGRlclRleHQgPSAiRW50ZXIgS2V5IChlLmcuLCBGLCBHKSIsCiAgICBSZW1vdmVUZXh0QWZ0ZXJGb2N1c0xvc3QgPSB0cnVlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihpbnB1dCkKICAgICAgICBsb2NhbCBuZXdLZXkgPSBFbnVtLktleUNvZGVbaW5wdXQ6dXBwZXIoKV0gLS0gQ29udmVydGl0IGVuIEVudW0uS2V5Q29kZQogICAgICAgIGlmIG5ld0tleSB0aGVuCiAgICAgICAgICAgIGFjdGl2YXRpb25LZXkgPSBuZXdLZXkKICAgICAgICAgICAgUmF5ZmllbGQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIktleSBDaGFuZ2VkIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiTm91dmVsbGUgdG91Y2hlIDogIiAuLiBpbnB1dDp1cHBlcigpLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgIH0pCiAgICAgICAgZWxzZQogICAgICAgICAgICBSYXlmaWVsZDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiSW52YWxpZCBLZXkiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJWZXVpbGxleiBlbnRyZXIgdW5lIHRvdWNoZSB2YWxpZGUuIiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCn0pCgpsb2NhbCBmdW5jdGlvbiBjcmVhdGVUZWxlcG9ydFRvb2woKQogICAgbG9jYWwgdG9vbCA9IEluc3RhbmNlLm5ldygiVG9vbCIpCiAgICB0b29sLk5hbWUgPSAiVGVsZXBvcnQgVG9vbCIgLS0gQWpvdXQgZGUgbCdlc3BhY2UKICAgIHRvb2wuUmVxdWlyZXNIYW5kbGUgPSBmYWxzZSAtLSBQYXMgZGUgbW9kw6hsZSByZXF1aXMKICAgIHRvb2wuQ2FuQmVEcm9wcGVkID0gZmFsc2UKCiAgICAtLSBBY3Rpb24gbG9yc3F1J29uIMOpcXVpcGUgbCdvdXRpbAogICAgdG9vbC5FcXVpcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBtb3VzZSA9IHBsYXllcjpHZXRNb3VzZSgpCiAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gcGxheWVyLkNoYXJhY3RlciBvciBwbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6V2FpdCgpCiAgICAgICAgbG9jYWwgcm9vdFBhcnQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQoKICAgICAgICBpZiByb290UGFydCB0aGVuCiAgICAgICAgICAgIC0tIENvbm5lY3RlIGwnw6l2w6luZW1lbnQgZGUgY2xpYwogICAgICAgICAgICBtb3VzZS5CdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFBvc2l0aW9uID0gbW91c2UuSGl0LlBvc2l0aW9uCiAgICAgICAgICAgICAgICBsb2NhbCBjdXJyZW50T3JpZW50YXRpb24gPSByb290UGFydC5DRnJhbWUgLSByb290UGFydC5Qb3NpdGlvbgoKICAgICAgICAgICAgICAgIC0tIFTDqWzDqXBvcnRhdGlvbiDDoCBsJ2VuZHJvaXQgY2xpcXXDqSBlbiBjb25zZXJ2YW50IG9yaWVudGF0aW9uIGV0IGNvbXBvcnRlbWVudAogICAgICAgICAgICAgICAgcm9vdFBhcnQuQ0ZyYW1lID0gY3VycmVudE9yaWVudGF0aW9uICsgVmVjdG9yMy5uZXcodGFyZ2V0UG9zaXRpb24uWCwgdGFyZ2V0UG9zaXRpb24uWSArIDUsIHRhcmdldFBvc2l0aW9uLlopCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICByZXR1cm4gdG9vbAplbmQKCgoKLS0gQWpvdXQgZHUgYm91dG9uIHBvdXIgZG9ubmVyIGwnb3V0aWwKVG9vbHNUYWI6Q3JlYXRlQnV0dG9uKHsKICAgIE5hbWUgPSAiR2l2ZSBUZWxlcG9ydCBUb29sIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGxvY2FsIGJhY2twYWNrID0gcGxheWVyOldhaXRGb3JDaGlsZCgiQmFja3BhY2siKQoKICAgICAgICAtLSBDcsOpYXRpb24gZXQgYWpvdXQgZGUgbCdvdXRpbCBkYW5zIGwnaW52ZW50YWlyZQogICAgICAgIGxvY2FsIHRlbGVwb3J0VG9vbCA9IGNyZWF0ZVRlbGVwb3J0VG9vbCgpCiAgICAgICAgdGVsZXBvcnRUb29sLlBhcmVudCA9IGJhY2twYWNrCgogICAgICAgIFJheWZpZWxkOk5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRvb2wgQWRkZWQiLAogICAgICAgICAgICBDb250ZW50ID0gIkwnb3V0aWwgZGUgdMOpbMOpcG9ydGF0aW9uIGEgw6l0w6kgYWpvdXTDqSDDoCB2b3RyZSBpbnZlbnRhaXJlLiIsCiAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgIH0pCiAgICBlbmQKfSkKCi0tIEZvbmN0aW9uIHBvdXIgY3LDqWVyIGwnb3V0aWwgZGUgIkJhbmciCmxvY2FsIGZ1bmN0aW9uIGNyZWF0ZUJhbmdUb29sKCkKICAgIGxvY2FsIHRvb2wgPSBJbnN0YW5jZS5uZXcoIlRvb2wiKQogICAgdG9vbC5OYW1lID0gIkJhbmdUb29sIgogICAgdG9vbC5SZXF1aXJlc0hhbmRsZSA9IGZhbHNlIC0tIFBhcyBkZSBtb2TDqGxlIHJlcXVpcwogICAgdG9vbC5DYW5CZURyb3BwZWQgPSBmYWxzZQoKICAgIC0tIFZhcmlhYmxlcyBwb3VyIHN1aXZyZSBsZSBqb3VldXIgY2libMOpCiAgICBsb2NhbCBpc0JhbmdpbmcgPSBmYWxzZQogICAgbG9jYWwgY3VycmVudFRhcmdldCA9IG5pbAoKICAgIC0tIEZvbmN0aW9uIHBvdXIgYXJyw6p0ZXIgZGUgc3VpdnJlCiAgICBsb2NhbCBmdW5jdGlvbiBzdG9wQmFuZ2luZygpCiAgICAgICAgaWYgaXNCYW5naW5nIGFuZCBjdXJyZW50VGFyZ2V0IHRoZW4KICAgICAgICAgICAgc3RvcEZvbGxvd2luZygpIC0tIEFycsOqdGUgbGUgc3VpdmkKICAgICAgICAgICAgY3VycmVudFRhcmdldCA9IG5pbAogICAgICAgICAgICBpc0JhbmdpbmcgPSBmYWxzZQogICAgICAgICAgICBSYXlmaWVsZDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQmFuZyBEw6lzYWN0aXbDqSIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIlZvdXMgbmUgc3VpdmV6IHBsdXMgcGVyc29ubmUuIiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gNQogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCgogICAgLS0gQWN0aW9uIGxvcnNxdSdvbiBjbGlxdWUgYXZlYyBsJ291dGlsCiAgICB0b29sLkFjdGl2YXRlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBtb3VzZSA9IHBsYXllcjpHZXRNb3VzZSgpCiAgICAgICAgbG9jYWwgdGFyZ2V0ID0gbW91c2UuVGFyZ2V0IC0tIFBhcnRpZSBjbGlxdcOpZSBkYW5zIGxlIGpldQoKICAgICAgICAtLSBWw6lyaWZpZSBzaSBvbiBjbGlxdWUgc3VyIHVuIGpvdWV1cgogICAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0LlBhcmVudCBhbmQgdGFyZ2V0LlBhcmVudDpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHRhcmdldFBsYXllciA9IGdhbWUuUGxheWVyczpHZXRQbGF5ZXJGcm9tQ2hhcmFjdGVyKHRhcmdldC5QYXJlbnQpCgogICAgICAgICAgICBpZiB0YXJnZXRQbGF5ZXIgYW5kIHRhcmdldFBsYXllciB+PSBwbGF5ZXIgYW5kIHRhcmdldFBsYXllciB+PSBjdXJyZW50VGFyZ2V0IHRoZW4KICAgICAgICAgICAgICAgIHN0b3BCYW5naW5nKCkgLS0gQXJyw6p0ZSBsZSBzdWl2aSBwcsOpY8OpZGVudCBzJ2lsIHkgZW4gYSB1bgogICAgICAgICAgICAgICAgY3VycmVudFRhcmdldCA9IHRhcmdldFBsYXllcgogICAgICAgICAgICAgICAgaXNCYW5naW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgc3RhcnRGb2xsb3dpbmcoKSAtLSBMYW5jZXIgbGUgc3VpdmkKICAgICAgICAgICAgICAgIFJheWZpZWxkOk5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQmFuZyBBY3RpdsOpIiwKICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIlZvdXMgc3VpdmV6ICIgLi4gdGFyZ2V0UGxheWVyLk5hbWUsCiAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAgIC0tIFNpIG9uIGNsaXF1ZSBhaWxsZXVycyBldCBxdSdvbiBzdWl0IHF1ZWxxdSd1biwgYXJyw6p0ZXIgbGUgQmFuZwogICAgICAgICAgICBpZiBpc0JhbmdpbmcgdGhlbgogICAgICAgICAgICAgICAgc3RvcEJhbmdpbmcoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICByZXR1cm4gdG9vbAplbmQKCi0tIEFqb3V0IGR1IGJvdXRvbiBwb3VyIGRvbm5lciBsJ291dGlsICJCYW5nIgpUb29sc1RhYjpDcmVhdGVCdXR0b24oewogICAgTmFtZSA9ICJHaXZlIEJhbmcgVG9vbCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBsb2NhbCBiYWNrcGFjayA9IHBsYXllcjpXYWl0Rm9yQ2hpbGQoIkJhY2twYWNrIikKCiAgICAgICAgLS0gQ3LDqWF0aW9uIGV0IGFqb3V0IGRlIGwnb3V0aWwgZGFucyBsJ2ludmVudGFpcmUKICAgICAgICBsb2NhbCBiYW5nVG9vbCA9IGNyZWF0ZUJhbmdUb29sKCkKICAgICAgICBiYW5nVG9vbC5QYXJlbnQgPSBiYWNrcGFjawoKICAgICAgICBSYXlmaWVsZDpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJUb29sIEFkZGVkIiwKICAgICAgICAgICAgQ29udGVudCA9ICJMJ291dGlsIGRlIEJhbmcgYSDDqXTDqSBham91dMOpIMOgIHZvdHJlIGludmVudGFpcmUuIiwKICAgICAgICAgICAgRHVyYXRpb24gPSA1CiAgICAgICAgfSkKICAgIGVuZAp9KQoKLS0gQWpvdXQgZGVzIGJvdXRvbnMgZGUgdMOpbMOpcG9ydGF0aW9uIGRhbnMgbGEgY2F0w6lnb3JpZSAi8J+TjSBUw6lsw6lwb3J0YXRpb24iCmxvY2FsIGRlc3RpbmF0aW9ucyA9IHsKICAgIHtOYW1lID0gIi0gU2FsbGUgcHJpdsOpIChBIGPDtHTDqS9lbiBkZWhvcnMpIiwgUG9zaXRpb24gPSBWZWN0b3IzLm5ldyg0MjIxLjQ1LCAzLCAyMC44Nzk5KX0sCiAgICB7TmFtZSA9ICItIFNhbGxlIHByaXbDqSAoQSBsJ2ludGVyaWV1cmUpIiwgUG9zaXRpb24gPSBWZWN0b3IzLm5ldyg0MjIwLjM1LCA1LjkyMjc3LCA2OC40ODY4KX0sCiAgICB7TmFtZSA9ICItIEbDqWUgZW1wbGFjZW1lbnQiLCBQb3NpdGlvbiA9IFZlY3RvcjMubmV3KC0xMTUuNjk4LCAzMy43MTgzLCAtNDYuNzcxNyl9LAogICAge05hbWUgPSAiLSBEb251dHMiLCBQb3NpdGlvbiA9IFZlY3RvcjMubmV3KC03OC41ODQyLCAzLjE4NTQzLCAtNzkuMzM0KX0sCiAgICB7TmFtZSA9ICItIE1pbGlldSBkZSBsYSBtYXAiLCBQb3NpdGlvbiA9IFZlY3RvcjMubmV3KDI3LjQyOTMsIDUsIDE3Ljg1MSl9LAogICAge05hbWUgPSAiLSBHcmFuZCBCw6J0aW1lbnQiLCBQb3NpdGlvbiA9IFZlY3RvcjMubmV3KDIxMS40MywgMjMuNDEyNywgNjcuOTkwOCl9LAogICAge05hbWUgPSAiLSBNdXIgKE5vdGVQYWQpIiwgUG9zaXRpb24gPSBWZWN0b3IzLm5ldyg1OS45NDQ2LCAzLCAyNTUuNzUpfSwKICAgIHtOYW1lID0gIi0gVG91ciAoQXUgdG9wKSIsIFBvc2l0aW9uID0gVmVjdG9yMy5uZXcoNTkuMzEzNiwgMzEzLjMxMywgMjI3LjE3OCl9LAp9Cgpsb2NhbCBmdW5jdGlvbiBhcHBseVRyYW5zcGFyZW5jeUVmZmVjdChjaGFyYWN0ZXIpCiAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgIGxvY2FsIHBhcnRzID0gY2hhcmFjdGVyOkdldERlc2NlbmRhbnRzKCkKICAgICAgICBsb2NhbCBvcmlnaW5hbFRyYW5zcGFyZW5jaWVzID0ge30gLS0gVGFibGUgcG91ciBzdG9ja2VyIGxlcyB0cmFuc3BhcmVuY2VzIG9yaWdpbmFsZXMKICAgICAgICAKICAgICAgICAtLSBTYXV2ZWdhcmRlIGRlcyB0cmFuc3BhcmVuY2VzIG9yaWdpbmFsZXMKICAgICAgICBmb3IgXywgcGFydCBpbiBpcGFpcnMocGFydHMpIGRvCiAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIG9yaWdpbmFsVHJhbnNwYXJlbmNpZXNbcGFydF0gPSBwYXJ0LlRyYW5zcGFyZW5jeQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgZm9yIGkgPSAxLCAxMCBkbyAtLSBBdWdtZW50YXRpb24gZGVzIGFsdGVybmFuY2VzIMOgIDEwCiAgICAgICAgICAgIGZvciBfLCBwYXJ0IGluIGlwYWlycyhwYXJ0cykgZG8KICAgICAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIGFuZCBwYXJ0LlRyYW5zcGFyZW5jeSA8IDEgdGhlbgogICAgICAgICAgICAgICAgICAgIHBhcnQuVHJhbnNwYXJlbmN5ID0gKGkgJSAyID09IDApIGFuZCAwLjUgb3IgMCAtLSBBbHRlcm5hbmNlIGVudHJlIDAgZXQgMC41CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpIC0tIFRlbXBzIGVudHJlIGxlcyBhbHRlcm5hbmNlcyBhdWdtZW50w6kgcG91ciB1biBlZmZldCBwbHVzIGxvbmcKICAgICAgICBlbmQKCiAgICAgICAgLS0gUmV0b3VyIGF1eCB0cmFuc3BhcmVuY2VzIG9yaWdpbmFsZXMgw6AgbGEgZmluCiAgICAgICAgZm9yIHBhcnQsIG9yaWdpbmFsVHJhbnNwYXJlbmN5IGluIHBhaXJzKG9yaWdpbmFsVHJhbnNwYXJlbmNpZXMpIGRvCiAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIHBhcnQuVHJhbnNwYXJlbmN5ID0gb3JpZ2luYWxUcmFuc3BhcmVuY3kgLS0gUsOpaW5pdGlhbGlzYXRpb24KICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgoKLS0gQ3LDqWF0aW9uIGRlcyBib3V0b25zIGRlIHTDqWzDqXBvcnRhdGlvbgpmb3IgXywgZGVzdGluYXRpb24gaW4gaXBhaXJzKGRlc3RpbmF0aW9ucykgZG8KICAgIFRwVGFiOkNyZWF0ZUJ1dHRvbih7CiAgICAgICAgTmFtZSA9IGRlc3RpbmF0aW9uLk5hbWUsCiAgICAgICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBwbGF5ZXIuQ2hhcmFjdGVyIG9yIHBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKICAgICAgICAgICAgbG9jYWwgcm9vdFBhcnQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgICAgICBpZiByb290UGFydCB0aGVuCiAgICAgICAgICAgICAgICAtLSBUw6lsw6lwb3J0ZSBsZSBqb3VldXIKICAgICAgICAgICAgICAgIHJvb3RQYXJ0LkNGcmFtZSA9IENGcmFtZS5uZXcoZGVzdGluYXRpb24uUG9zaXRpb24gKyBWZWN0b3IzLm5ldygwLCA1LCAwKSkgLS0gQWpvdXQgZGUgNSBwb3VyIMOpdml0ZXIgbGUgc29sCiAgICAgICAgICAgICAgICAtLSBBcHBsaXF1ZSBsJ2VmZmV0IGRlIHRyYW5zcGFyZW5jZQogICAgICAgICAgICAgICAgYXBwbHlUcmFuc3BhcmVuY3lFZmZlY3QoY2hhcmFjdGVyKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIH0pCmVuZAoKTWFpblRhYjpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICItIFNwYW1tZXIgJ1N0b3AnIChNdXIgVGV4dCkiLAogICAgRGVmYXVsdCA9IGZhbHNlLCAtLSBQYXIgZMOpZmF1dCBkw6ljb2Now6kKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oc3RhdGUpCiAgICAgICAgdG9nZ2xlVGV4dFNlbmRpbmcoc3RhdGUpIC0tIEFjdGl2ZSBvdSBkw6lzYWN0aXZlIHNlbG9uIGwnw6l0YXQgZGUgbGEgY2FzZQogICAgZW5kCn0pCgpNZW51OkNyZWF0ZVRvZ2dsZSh7CiAgICBOYW1lID0gIi0gQmFzZVBsYXRlICggVmlzaWJsZSAvIEludmlzaWJsZSApIDoiLAogICAgRGVmYXVsdCA9IHRydWUsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIGJhc2VTZWdtZW50c1Zpc2libGUgPSB2YWx1ZQogICAgICAgIC0tIE1pc2Ugw6Agam91ciBkZSBsYSB2aXNpYmlsaXTDqSBkZXMgc2VnbWVudHMgZGFucyBXb3Jrc3BhY2UKICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgcGFydDpJc0EoIlBhcnQiKSBhbmQgcGFydC5OYW1lID09ICJCYXNlU2VnbWVudCIgdGhlbgogICAgICAgICAgICAgICAgcGFydC5UcmFuc3BhcmVuY3kgPSBiYXNlU2VnbWVudHNWaXNpYmxlIGFuZCAwIG9yIDEKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCmZvciBfLCBwYXJ0IGluIHBhaXJzKHdvcmtzcGFjZTpHZXRDaGlsZHJlbigpKSBkbwogICAgaWYgcGFydDpJc0EoIlBhcnQiKSBhbmQgcGFydC5OYW1lID09ICJCYXNlU2VnbWVudCIgdGhlbgogICAgICAgIHBhcnQuQ2FuQ29sbGlkZSA9IGJhc2VTZWdtZW50c0NvbGxpZGFibGUKICAgIGVuZAplbmQKCi0tIENyw6llciBsZSBUb2dnbGUKTWVudTpDcmVhdGVUb2dnbGUoewogICAgTmFtZSA9ICItIEJhc2VQbGF0ZSBDb2xsaXNpb25zICggT24gLyBPZmYgKSA6IiwKICAgIERlZmF1bHQgPSBiYXNlU2VnbWVudHNDb2xsaWRhYmxlLCAtLSBEw6lmaW5pdCBsJ8OpdGF0IGluaXRpYWwgw6AgY29jaMOpCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKHZhbHVlKQogICAgICAgIGJhc2VTZWdtZW50c0NvbGxpZGFibGUgPSB2YWx1ZQogICAgICAgIC0tIE1pc2Ugw6Agam91ciBkZXMgY29sbGlzaW9ucyBkZXMgc2VnbWVudHMgZGFucyBXb3Jrc3BhY2UKICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgaWYgcGFydDpJc0EoIlBhcnQiKSBhbmQgcGFydC5OYW1lID09ICJCYXNlU2VnbWVudCIgdGhlbgogICAgICAgICAgICAgICAgcGFydC5DYW5Db2xsaWRlID0gYmFzZVNlZ21lbnRzQ29sbGlkYWJsZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQ==]]
local decoded = game:HttpGet(script, true)
assert(loadstring(decoded))()
